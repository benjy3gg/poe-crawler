{% load thumbnail %}
<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <script src="{% static 'js/gif.worker.js' %}"></script>
    <script src="{% static 'js/gif.js' %}"></script>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<h1>List of SkillTrees for {{object.name}}</h1>

<img id="render" src="" style="width: 75%;height: auto;">

<ul>
{% for skilltree in skilltrees %}
    <li>{{ skilltree.created_at }}{{ skilltree.account.name }} - {{ skilltree.character.name }}:
      {% if skilltree.image_file %}
        {% thumbnail skilltree.image_file "500x500" crop="center" as im %}
          <img class="imgs" src="{{ im.url }}" style="display:none;" width="{{ im.width }}" height="{{ im.height }}">
        {% endthumbnail %}
      {% endif %}
      <a href=" {{ skilltree.url }}">({{ skilltree.level }})</a></li>
{% endfor %}
</ul>

<script type="text/javascript">
    window.onload = function() {
        var gif = new GIF({
          workers: 2,
          quality: 10,
          workerScript: "{% static 'js/gif.worker.js' %}",
            debug: true,
            width: 2560,
            height: 2560
        });

        var elements = document.getElementsByClassName('imgs');
        for (var i = 0; i < elements.length; ++i) {
            var item = elements[i];
            //item.crossOrigin = "Anonymous";
            gif.addFrame(item);
        }

        setTimeout(function() {gif.render();}, 1000);

        gif.on('finished', function(blob) {
            renderimg = document.getElementById("render");
            renderimg.src = URL.createObjectURL(blob);
        });
    }
</script>
</body>
</html>
